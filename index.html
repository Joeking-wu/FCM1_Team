<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>Google Sheet Demo</title>
</head>
<body>
  <h1>Google 試算表讀寫範例</h1>

  <button onclick="loadData()">讀取資料</button>
  <table border="1" id="sheetData"></table>

  <h2>新增資料</h2>
  <input type="text" id="col1" placeholder="欄1">
  <input type="text" id="col2" placeholder="欄2">
  <input type="text" id="col3" placeholder="欄3">
  <button onclick="writeData()">寫入</button>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwFcEUng7MjofdemrBOkNeNCPVAbuBUr78ghBD6NYpWVeCmFh4nrAYHV-qecm6EP5YS/exec";

    async function loadData() {
      const res = await fetch(API_URL);
      const data = await res.json();
      const table = document.getElementById("sheetData");
      table.innerHTML = "";
      data.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });
        table.appendChild(tr);
      });
    }

    async function writeData() {
      const col1 = document.getElementById("col1").value;
      const col2 = document.getElementById("col2").value;
      const col3 = document.getElementById("col3").value;

      await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ row: [col1, col2, col3] })
      });

      // 重新載入最新資料
      loadData();
    }
  </script>
</body>
</html>
